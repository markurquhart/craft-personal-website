{% extends "_layout.twig" %}

{% block content %}
    <h1>{{ entry.title }}</h1>

    <div class="meta">
        {% if entry.destination %}
            <span>üìç {{ entry.destination }}</span>
        {% endif %}
        {% if entry.startDate and entry.endDate %}
            | <span>üóì {{ entry.startDate|date('M j') }} - {{ entry.endDate|date('M j, Y') }}</span>
        {% elseif entry.startDate %}
            | <span>üóì {{ entry.startDate|date('F j, Y') }}</span>
        {% endif %}
        {% if entry.travelType %}
            | <span>{{ entry.travelType }}</span>
        {% endif %}
    </div>

    {% if entry.featuredImage|length %}
        <div class="featured-image" style="margin: 2rem 0;">
            {% set image = entry.featuredImage.one() %}
            {% if image %}
                <img src="{{ image.url }}" alt="{{ image.title }}" style="max-width: 100%; height: auto; border-radius: 8px;">
            {% endif %}
        </div>
    {% endif %}

    {% if entry.postBody %}
        <div class="content">
            {{ entry.postBody }}
        </div>
    {% endif %}

    {# Show locations #}
    {% if entry.locations|length %}
        <div style="margin: 2rem 0;">
            {% for location in entry.locations.all() %}
                <a href="{{ location.url }}" class="tag">üìç {{ location.title }}</a>
            {% endfor %}
        </div>
    {% endif %}

    {% if entry.gallery|length %}
        <div class="content">
            <h2>Travel Photos</h2>
            <div class="gallery">
                {% for image in entry.gallery.all() %}
                    <img src="{{ image.url }}" alt="{{ image.title }}">
                {% endfor %}
            </div>
        </div>
    {% endif %}

    {# Related Content - Photography Albums #}
    {% if entry.relatedPhotographyAlbums|length %}
        <section style="margin: 3rem 0; padding: 2rem; background: #f8f9fa; border-radius: 8px;">
            <h2>üì∏ Photography Albums from this Trip</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem; margin-top: 1.5rem;">
                {% for album in entry.relatedPhotographyAlbums.all() %}
                    <div>
                        {% if album.featuredImage|length %}
                            {% set image = album.featuredImage.one() %}
                            <a href="{{ album.url }}">
                                <img src="{{ image.url }}" alt="{{ album.title }}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">
                            </a>
                        {% endif %}
                        <h3 style="margin-top: 0;"><a href="{{ album.url }}">{{ album.title }}</a></h3>
                        {% if album.dateTaken %}
                            <div class="meta">üìÖ {{ album.dateTaken|date('F j, Y') }}</div>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
        </section>
    {% endif %}

    {# Related Content - Blog Posts #}
    {% if entry.relatedBlogPosts|length %}
        <section style="margin: 3rem 0;">
            <h2>üí≠ Blog Posts about this Trip</h2>
            <div style="display: grid; gap: 2rem; margin-top: 1.5rem;">
                {% for post in entry.relatedBlogPosts.all() %}
                    <article style="padding: 1.5rem; background: #fff; border: 1px solid #e1e8ed; border-radius: 8px;">
                        <div style="display: grid; grid-template-columns: 200px 1fr; gap: 1.5rem;">
                            {% if post.featuredImage|length %}
                                {% set image = post.featuredImage.one() %}
                                <a href="{{ post.url }}">
                                    <img src="{{ image.url }}" alt="{{ post.title }}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px;">
                                </a>
                            {% endif %}
                            <div>
                                <h3 style="margin-top: 0;"><a href="{{ post.url }}">{{ post.title }}</a></h3>
                                <div class="meta" style="color: #666; margin-bottom: 0.5rem;">
                                    üìÖ {{ post.postDate|date('F j, Y') }}
                                </div>
                                {% if post.postSummary %}
                                    <p>{{ post.postSummary }}</p>
                                {% elseif post.postBody %}
                                    <p>{{ post.postBody|length > 200 ? post.postBody|slice(0, 200) ~ '...' : post.postBody }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </article>
                {% endfor %}
            </div>
        </section>
    {% endif %}
{% endblock %}
