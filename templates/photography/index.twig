{% extends "_layout.twig" %}

{% block content %}
    <h1>Photography</h1>

    <p style="margin-bottom: 2rem;">My photo albums and collections.</p>

    {% set albums = craft.entries()
        .section('photography')
        .type('album')
        .level(1)
        .orderBy('dateTaken DESC')
        .all() %}

    {% if albums|length %}
        <ul class="entry-list">
            {% for album in albums %}
                <li>
                    {% if album.featuredImage|length %}
                        {% set image = album.featuredImage.one() %}
                        <img src="{{ image.url }}" alt="{{ image.title }}" style="width: 100%; height: 250px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">
                    {% endif %}

                    <h3><a href="{{ album.url }}">{{ album.title }}</a></h3>

                    <div class="meta">
                        {% if album.photoLocation %}
                            üìç {{ album.photoLocation }}
                        {% endif %}
                        {% if album.dateTaken %}
                            | üìÖ {{ album.dateTaken|date('F j, Y') }}
                        {% endif %}
                        {% set photoCount = craft.entries()
                            .section('photography')
                            .type('photo')
                            .descendantOf(album)
                            .count() %}
                        {% if photoCount %}
                            | üì∏ {{ photoCount }} photo{{ photoCount != 1 ? 's' : '' }}
                        {% endif %}
                    </div>

                    {% if album.description %}
                        <p>{{ album.description|length > 250 ? album.description|slice(0, 250) ~ '...' : album.description }}</p>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p style="padding: 2rem; background: #f8f9fa; border-radius: 8px; text-align: center;">
            No photo albums yet. Create some in the Craft control panel!
        </p>
    {% endif %}
{% endblock %}
